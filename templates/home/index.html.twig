{% extends 'layout.html.twig' %}

{% block title %}Carhabty
{% endblock %}

{% block LinksCss %}
	{{ parent() }}
	<link type="text/css" rel="stylesheet" href="{{ asset ('css/popup.css')}}">
	<link rel="stylesheet" href="{{ asset ('css/stylebutton.css') }}">
	<style>

		.request-card {
			background: linear-gradient(135deg, #ffffff, #f7f8fc);
			border-radius: 15px;
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			padding: 15px;
			transition: all 0.3s ease;
		}

		.request-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 8px 20px rgba(255, 107, 53, 0.3);
		}

		.request-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 10px;
		}

		.request-title {
			font-weight: 700;
			font-size: 16px;
			color: #222;
			line-height: 1.3;
			flex: 1;
		}

		.request-badge {
			background: linear-gradient(135deg, #ff6b35 0%, #fca311 50%, #2ec4b6 100%);
			color: #fff;
			font-size: 12px;
			border-radius: 12px;
			padding: 5px 12px;
			font-weight: 700;
			letter-spacing: 0.5px;
			text-transform: uppercase;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
			display: inline-block;
			transition: all 0.3s ease;
		}

		.request-badge:hover {
			transform: scale(1.05);
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
		}
		.request-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 8px;
		}


		.request-meta {
			font-size: 13px;
			color: #666;
			display: flex;
			justify-content: space-between;
			flex-wrap: wrap;
			gap: 4px;
			margin-bottom: 10px;
		}

		.request-image img {
			width: 100%;
			height: 220px;
			object-fit: cover;
			border-radius: 10px;
			margin-bottom: 10px;
		}

		.request-description {
			font-size: 14px;
			color: #333;
			line-height: 1.4;
			min-height: 50px;
			margin-bottom: 10px;
		}

		.request-meta {
			display: flex;
			flex-wrap: wrap;
			gap: 10px;
			color: #555;
			font-size: 14px;
			align-items: center;
			margin-bottom: 10px;
		}

		.request-meta i {
			color: #ff6b35;
			margin-right: 5px;
			font-size: 15px;
		}

		.btn-register i {
			margin-right: 8px;
			font-size: 16px;
			color: #fff;
		}
		.btn-register {
			background: linear-gradient(45deg, #ff6b35, #ff8c00);
			border: none;
			color: white;
			font-weight: 600;
			transition: 0.3s ease;
		}
		.btn-register:hover {
			background: linear-gradient(45deg, #ff8c00, #ff6b35);
			transform: translateY(-2px);
		}
		/* Effet au survol */
		.btn-register:hover {
			background: linear-gradient(45deg, #ff8c00, #ff6b35);
			transform: translateY(-2px);
			box-shadow: 0 4px 10px rgba(255, 107, 53, 0.4);
		}

		/* Animation de l'enveloppe quand la carte est survol√©e */
		.request-card:hover .btn-register i {
			animation: vibrate 0.3s linear infinite;
		}

		@keyframes vibrate {
			0% {
				transform: rotate(0deg);
			}
			25% {
				transform: rotate(10deg);
			}
			50% {
				transform: rotate(-10deg);
			}
			75% {
				transform: rotate(10deg);
			}
			100% {
				transform: rotate(0deg);
			}
		}
		/* üì± Responsive fixes */
		@media(max-width: 768px) {
			.request-card {
				padding: 12px;
				min-height: auto;
			}
			.request-title {
				font-size: 15px;
			}
			.request-meta {
				font-size: 12px;
			}
			.request-image img {
				height: 180px;
			}
		}


		.btn-propdemande {
			background: linear-gradient(45deg, #ff6b35, #ff9f1c);
			background: linear-gradient(45deg, #2ec4b6, #ff9f1c);
			color: white;
			box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
		}


		.btn-offer {
			background-color: #ff4d00;
			color: white;
			border: none;
			width: 100%;
			padding: 10px;
			border-radius: 10px;
			font-weight: 600;
			cursor: pointer;
			transition: background 0.2s ease;
		}
		.btn-offer:hover {
			background-color: #e64300;
		}

		.badge-custom {
			display: inline-block;
			padding: 3px;
			font-size: 11px;
			border-radius: 0 50em 50em 0;
			color: #ffffff;
			font-weight: 600;
			line-height: 23px;
			position: absolute;
			background: linear-gradient(45deg, #ff6b35, #ff9f1c);
			z-index: 1;
			top: 20px;
			box-shadow: 2px 1px 6px 2px rgb(0 0 0 / 10%), 0 4px 4px 0 rgb(0 0 0 / 15%) !important;
		}
		.badge-custom .box {
			height: 26px;
			width: 26px;
			background: linear-gradient(45deg, #ff6b35, #ff9f1c);
			color: #fff;
			display: inline-block;
			border-radius: 50%;
			text-align: center;
		}
	</style>
{% endblock %}

{% block Content %}


	<div class=" col-lg-12">

		<div class="aiz-carousel dots-inside-bottom mobile-img-auto-height" data-arrows="true" data-dots="true" data-autoplay="true" data-infinite="true">

			<div class="carousel-box">
				<a href="">
					<img class="d-block w-100 rounded" src="https://res.cloudinary.com/aladdineshoping/image/upload/v1645467378/icones/1645395075573_cykvht.jpg" onerror="this.onerror=null;this.src='assets/img/placeholder-rect.png';" alt="First slide">
				</a>
			</div>
			<div class="carousel-box">
				<a href="">
					<img class="d-block w-100 rounded" src="https://res.cloudinary.com/aladdineshoping/image/upload/v1645467377/icones/1645395075579_vgrob4.jpg" onerror="this.onerror=null;this.src='assets/img/placeholder-rect.png';" alt="First slide">
				</a>
			</div>


		</div>
	</div>

	{# categorie parent  #}
	<div id="section_home_categories">
		<section class="mb-4">
			<div class="container">
				<div class="px-2 py-4 px-md-4 py-md-3 bg-white shadow-sm rounded">

					<div class="d-flex mb-3 align-items-baseline border-bottom">
						<h3 class="h5 fw-700 mb-0">
							<span class="border-bottom border-primary border-width-2 pb-3 d-inline-block">
								Demandes r√©centes
							</span>
						</h3>
						<a href="{{path('app_demande_all')}}" class="ml-auto btn btn-register btn-sm shadow-md">Voir plus</a>
					</div>

					<!-- ‚úÖ AIZ Carousel -->
					<div class="aiz-carousel half-outside-arrow gutters-10" data-items="3" data-xl-items="3" data-lg-items="2" data-md-items="2" data-sm-items="1" data-xs-items="1" data-arrows="true" data-infinite="true">

						{% for demande in lastDemandes %}
							<div class="carousel-box">
								<div class="request-card">

									<div class="request-header">
										<div class="request-title">
											{% if demande.pieces|length > 0 %}
												{% for piece in demande.pieces %}
													{{ piece.designation }}
													{% if not loop.last %},
													{% endif %}
												{% endfor %}
											{% else %}
												{{ demande.marque }}
												{{ demande.modele }}
											{% endif %}
										</div>
										<div class="request-badge">
											{% if demande.vendeuroccasion == 1 %}
												Occasion
											{% else %}
												Neuf
											{% endif %}
										</div>
									</div>

									<div class="request-meta">
										<span>
											<i class="fas fa-map-marker-alt"></i>
											{{ demande.zone }}</span>
										<span>
											<i class="fas fa-user"></i>
											{{ demande.offrecompte ? demande.offrecompte.nom : 'Anonyme' }}</span>
										<span>
											<i class="far fa-clock"></i>
											{{ demande.datecreate|time_ago }}</span>
									</div>


									<div class="request-image">
										{% set photo = (demande.Pieces|first).photo ?? '/assets/img/placeholder.png' %}
										<img src="{{ photo }}" alt="photo" class="img-fit mx-auto rounded">
									</div>

									<p class="request-description">
										{% if demande.pieces|length > 0 %}
											{% for piece in demande.pieces|slice(0,3) %}
												{{ piece.observation }}
												{% if not loop.last %},
												{% endif %}
											{% endfor %}
											{% if demande.pieces|length > 3 %}...
											{% endif %}
										{% else %}
											Pas de description disponible.
										{% endif %}
									</p>

									<button class="btn btn-register w-100">
										<i class="fas fa-envelope-open-text"></i>
										Proposer un prix
									</button>

								</div>
							</div>
						{% else %}
							<p class="text-center text-muted">Aucune demande r√©cente.</p>
						{% endfor %}
					</div>
				</div>
			</div>
		</section>
	</div>

	{# fin categorie parent  #}
{% endblock %}
{% block javascript %}
	{{ parent() }}
	<script type="text/javascript"></script>
{% endblock %}

